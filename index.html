<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Signature Generator - RadiantBD</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Mona Sans from Google Fonts for the tool's UI -->
    <link href="https://fonts.googleapis.com/css2?family=Mona+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom color palette */
        :root {
            --color-navy: #1F3760; /* Dark Navy Blue */
            --color-orange: #FF7F00; /* Vibrant Orange */
            --color-light-bg: #f0f2f5;
            --color-dark-text: #333;
            --color-light-text: #ffffff;
            --color-placeholder: #d5d5d5;
            --color-border: #d1d5db;
            --color-preview-bg: #f9fafb;
            --color-link-section-bg: #2a3b7d; /* Original link section blue */
            --color-signature-name: #1F3760;
            --color-signature-title-department: #1a1a1a;
            --color-signature-contact: #4a5568;
        }

        /* Base styles for the body and container */
        body {
            font-family: 'Mona Sans', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--color-light-bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            box-sizing: border-box;
            color: var(--color-dark-text);
        }

        /* Header styles */
        header {
            background-color: var(--color-navy);
            color: var(--color-light-text);
            padding: 1rem 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            z-index: 10; /* Ensure header is on top */
            position: sticky; /* Sticky header */
            top: 0;
        }
        header .logo-img { /* Style for the new image logo */
            height: 40px; /* Adjust height as needed */
            filter: brightness(0) invert(1); /* Make the logo white */
            transition: transform 0.2s ease;
        }
        header .logo-img:hover {
            transform: scale(1.05); /* Slight scale on hover */
        }
        header nav a {
            color: var(--color-light-text);
            margin-left: 1.5rem;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        header nav a:hover {
            color: var(--color-orange);
        }

        /* Main content area */
        main {
            flex-grow: 1;
            padding: 2rem;
            display: flex;
            flex-direction: column; /* Default to column for mobile */
            align-items: center;
            gap: 2.5rem; /* Space between sections */
        }

        /* Tool container */
        .tool-container {
            background-color: var(--color-light-text);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
        }

        /* Form group styles */
        .form-group {
            margin-bottom: 16px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-dark-text);
        }
        input[type="text"],
        input[type="email"],
        input[type="tel"] {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            color: var(--color-dark-text); /* Input text color */
        }
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus {
            border-color: var(--color-orange); /* Focus border color */
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 127, 0, 0.2); /* Orange shadow on focus */
        }
        input::placeholder {
            color: var(--color-placeholder); /* Placeholder color */
            opacity: 1;
        }

        /* Signature preview area */
        .signature-preview {
            border: 1px solid var(--color-border);
            padding: 16px;
            background-color: var(--color-preview-bg);
            border-radius: 12px; /* Consistent border-radius */
            overflow: hidden;
            display: flex;
            flex-direction: column; /* Stack h2, iframe, and buttons */
            justify-content: flex-start; /* Align content to top */
            align-items: center;
            visibility: hidden;
            height: 0;
            padding-top: 0;
            padding-bottom: 0;
            border: none;
            transition: all 0.3s ease-in-out;
            width: 100%; /* Take full width of its grid area */
            box-sizing: border-box;
        }
        .signature-preview.visible {
            visibility: visible;
            height: auto; /* Restore height when visible */
            padding: 16px;
            border: 1px solid var(--color-border);
            overflow: visible; /* Allow overflow when visible to prevent clipping */
        }
        .signature-preview iframe {
            border: none;
            width: 100%;
            height: auto;
            display: block;
            min-height: 100px; /* Ensure a minimum height for the iframe content */
            flex-grow: 1; /* Allow iframe to take available height */
        }

        /* Buttons container outside preview */
        .action-buttons-container {
            margin-top: 1.5rem; /* Space between preview and buttons */
            display: flex;
            justify-content: center;
            gap: 1rem; /* Space between buttons */
            width: 100%;
            box-sizing: border-box;
        }
        .action-buttons-container button {
            padding: 8px 16px; /* Smaller padding */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px; /* Smaller font size */
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            flex-grow: 1; /* Allow buttons to grow and fill space */
            max-width: 180px; /* Limit max width for smaller buttons */
        }
        .action-buttons-container button:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        .action-buttons-container #copyHtmlBtn {
            background-color: var(--color-navy); /* Navy button */
            color: var(--color-light-text);
        }
        .action-buttons-container #copyHtmlBtn:hover {
            background-color: #1a2c4e; /* Darker navy */
            box-shadow: 0 4px 8px rgba(31, 55, 96, 0.2);
        }
        .action-buttons-container #copyVisualBtn {
            background-color: var(--color-orange); /* Orange button */
            color: var(--color-light-text);
        }
        .action-buttons-container #copyVisualBtn:hover {
            background-color: #e66f00; /* Darker orange */
            box-shadow: 0 4px 8px rgba(255, 127, 0, 0.2);
        }

        /* Tutorial Video Section */
        .video-section {
            text-align: center;
            background-color: var(--color-light-text);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
        }
        .video-section h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--color-navy);
            margin-bottom: 1.5rem;
        }
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        /* Footer styles */
        footer {
            background-color: var(--color-navy);
            color: var(--color-light-text);
            text-align: center;
            padding: 1.5rem;
            margin-top: auto; /* Push footer to the bottom */
            font-size: 0.9rem;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Signature styles - these will be injected into the iframe and used for HTML copy */
        /* IMPORTANT: These styles are critical for email client compatibility */
        .signature-container {
            font-family: 'Mona Sans', Arial, sans-serif;
            color: #333333;
            max-width: 320px; /* Adjusted to a common email signature width for compact size */
            width: 100%; /* Ensure it takes available width within the table */
            box-sizing: border-box;
            line-height: 1.4;
            /* Removed transform: scale() for email client compatibility */
            border-collapse: collapse; /* Ensure table borders collapse */
        }
        .signature-name {
            font-size: 13px; /* Increased font size for name */
            font-weight: bold;
            color: #1F3760;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .signature-title-department {
            font-size: 11px; /* Adjusted to match email font size */
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 8px; /* Adjusted margin */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
        }
        .signature-contact-item {
            font-size: 10px; /* Decreased font size for mobile, SIP, email, address */
            color: #4a5568;
            line-height: 1.5;
            margin-bottom: 2px; /* Adjusted margin */
            white-space: nowrap; /* Keep contact items on one line */
        }
        .signature-contact-item img { /* Targeting images for icons */
            vertical-align: middle;
            margin-right: 5px; /* Consistent gap for all icons */
            width: 12px; /* Adjusted icon size */
            height: 12px; /* Adjusted icon size */
        }
        .signature-link-section {
            background-color: #2a3b7d;
            padding: 6px 8px; /* Adjusted padding */
            /* Removed border-radius as it's often ignored */
            /* Using table for layout instead of flex */
            margin-top: 8px; /* Adjusted margin */
        }
        .signature-link-section a {
            color: white;
            text-decoration: none;
            font-size: 10px; /* Decreased font size for website */
            font-weight: 500;
            /* Removed display: flex and align-items: center from here */
        }
        .signature-link-section a img { /* Targeting images for social icons */
            margin-right: 3px; /* Adjusted margin */
            width: 16px; /* Adjusted icon size */
            height: 16px; /* Adjusted icon size */
            vertical-align: middle;
        }
        .social-icons {
            /* Handled by table cells in generated HTML */
        }
        .social-icons a {
            display: inline-block;
            margin-left: 6px; /* Adjusted margin */
        }
        .social-icons img {
            width: 16px; /* Adjusted icon size */
            height: 16px; /* Adjusted icon size */
            vertical-align: middle;
        }

        /* Responsive adjustments for Bento Grid */
        @media (min-width: 1024px) { /* Apply side-by-side layout for large screens and up */
            .main-content-grid {
                display: grid;
                grid-template-columns: 1fr 1fr; /* Two columns */
                grid-template-rows: auto auto; /* Two rows */
                grid-template-areas:
                    "generator preview-area"
                    "generator tutorial"; /* Generator spans two rows, preview and tutorial stack on right */
                gap: 2.5rem; /* Space between grid items */
                width: 100%;
                max-width: 1200px; /* Limit overall width of the grid */
                align-items: start; /* Align items to the start of their grid area */
            }
            .tool-container {
                grid-area: generator;
            }
            .right-column-content { /* New wrapper for preview and buttons */
                grid-area: preview-area;
                display: flex;
                flex-direction: column;
                gap: 1.5rem; /* Space between preview and buttons */
            }
            .signature-preview {
                margin-top: 0; /* Remove top margin when in grid */
                min-height: 200px; /* Give it a reasonable minimum height */
            }
            .video-section {
                grid-area: tutorial;
                margin-top: 0; /* Remove top margin when in grid */
            }
        }

        @media (max-width: 1023px) { /* Stack vertically on medium and small screens */
            .main-content-grid {
                display: flex;
                flex-direction: column;
                gap: 2.5rem;
                width: 100%;
                max-width: 800px; /* Max width for stacked layout */
            }
            .tool-container, .signature-preview, .video-section {
                margin: 0 auto; /* Center items when stacked */
            }
            .signature-preview {
                margin-top: 2rem; /* Add some space when stacked */
            }
            .right-column-content { /* Ensure it stacks on smaller screens */
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                max-width: 600px; /* Match tool-container max-width */
                margin: 0 auto; /* Center it */
                gap: 1.5rem; /* Space between preview and buttons */
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                text-align: center;
            }
            header nav {
                margin-top: 1rem;
            }
            header nav a {
                margin: 0 0.5rem;
            }
        }
        @media (max-width: 480px) {
            main {
                padding: 1rem;
            }
            .tool-container, .video-section, .signature-preview {
                padding: 1rem;
            }
            .action-buttons-container {
                flex-direction: column;
                gap: 10px;
            }
            .action-buttons-container button {
                width: 100%;
                max-width: none; /* Remove max-width on mobile for full width */
            }
        }
    </style>
</head>
<body>

    <header>
        <a href="#" class="logo-link">
            <img src="https://ik.imagekit.io/mwyisb0h4/RCL-New-Logo.png" alt="RadiantBD Logo" class="logo-img">
        </a>
        <nav>
            <a href="#tool">Signature Tool</a>
            <a href="#tutorial">Tutorial</a>
            <a href="#contact">Contact</a>
        </nav>
    </header>

    <main>
        <div class="main-content-grid">
            <section id="tool" class="tool-container">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Input Your information Here</h2>

                <div class="form-group">
                    <label for="fullName">Full Name:</label>
                    <input type="text" id="fullName" value="" placeholder="e.g., ENGR. SHAHRIAR TANVIR (SHAN)">
                </div>
                <div class="form-group">
                    <label for="title">Designation:</label>
                    <input type="text" id="title" value="" placeholder="e.g., Senior Manager">
                </div>
                <div class="form-group">
                    <label for="department">Department (Optional):</label>
                    <input type="text" id="department" value="" placeholder="e.g., Network Operations">
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" value="" placeholder="e.g., shan.tanvir@radiantbd.com">
                </div>
                <div class="form-group">
                    <label for="mobileNumber">Mobile Number:</label>
                    <input type="tel" id="mobileNumber" value="" placeholder="e.g., +8801755-123456" maxlength="14">
                </div>
                <div class="form-group">
                    <label for="sipNumber">SIP Number (Optional):</label>
                    <input type="tel" id="sipNumber" value="" placeholder="e.g., +8809604-114455" maxlength="14">
                </div>
            </section>

            <!-- New wrapper for preview and buttons -->
            <div class="right-column-content">
                <section class="signature-preview" id="signaturePreviewContainer">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4 text-center">Email Signature Preview:</h2>
                    <iframe id="signatureFrame"></iframe>
                </section>

                <div class="action-buttons-container">
                    <button id="copyHtmlBtn">Copy HTML</button>
                    <button id="copyVisualBtn">Copy Visual</button>
                </div>
            </div>

            <section id="tutorial" class="video-section">
                <h2>Email Signature Setup Guide</h2>
                <div class="video-container">
                    <!-- Replace 'VIDEO_ID_HERE' with your actual YouTube video ID -->
                    <iframe src="https://www.youtube.com/embed/VIDEO_ID_HERE" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <p class="mt-4 text-gray-600">Watch this quick tutorial to get started with your new email signature!</p>
            </section>
        </div>
    </main>

    <footer id="contact">
        <p>&copy; 2025 Radiant Communications Limited. All rights reserved.</p>
        <p>Contact: support@radiantbd.com</p>
    </footer>

    <!-- Custom Message Box for alerts -->
    <div id="messageBox" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl text-center">
            <p id="messageText" class="text-lg font-medium mb-4"></p>
            <button id="closeMessageBox" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">OK</button>
        </div>
    </div>

    <script>
        // Get references to input elements
        const fullNameInput = document.getElementById('fullName');
        const titleInput = document.getElementById('title');
        const departmentInput = document.getElementById('department');
        const emailInput = document.getElementById('email');
        const mobileNumberInput = document.getElementById('mobileNumber');
        const sipNumberInput = document.getElementById('sipNumber');

        // Get references to preview and button elements
        const signatureFrame = document.getElementById('signatureFrame');
        const signaturePreviewContainer = document.getElementById('signaturePreviewContainer');
        const copyHtmlBtn = document.getElementById('copyHtmlBtn');
        const copyVisualBtn = document.getElementById('copyVisualBtn');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');
        const closeMessageBox = document.getElementById('closeMessageBox');

        // URL for the company logo
        const logoUrl = "https://ik.imagekit.io/mwyisb0h4/RCL-New-Logo.png"; // Updated logo URL

        // Fixed company information
        const fixedAddressPart1 = "Bashati Condominium, Suite# D:5-6";
        const fixedAddressPart2_line1 = "House# 15, Road# 17, Banani C/A"; // Split for line break
        const fixedAddressPart2_line2 = "Dhaka-1213"; // Split for line break
        const fixedWebsite = "https://www.radiantbd.com";
        const fixedFacebook = "https://www.facebook.com/RADIANTISP";
        const fixedLinkedin = "https://www.linkedin.com/company/radiant-communications-ltd./?originalSubdomain=bd";
        const fixedYoutube = "#";
        const fixedInstagram = ""; // Leave empty if no Instagram link

        // Function to display a custom message box
        function showMessageBox(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        // Event listener to close the message box
        closeMessageBox.addEventListener('click', () => {
            messageBox.classList.add('hidden');
        });

        // Icon Image URLs (using ik.imagekit.io as requested)
        // Note: These are placeholder URLs. For production, ensure your images are publicly accessible and stable.
        const phoneIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/phone.png" alt="Phone" width="10" height="10" style="vertical-align: middle; margin-right: 5px;">`; // Decreased size
        const mailIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/mail.png" alt="Mail" width="10" height="10" style="vertical-align: middle; margin-right: 5px;">`; // Decreased size
        const mapPinIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/location.png" alt="Location" width="10" height="10" style="vertical-align: top; margin-right: 5px;">`; // Decreased size
        const linkIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/link.png" alt="Website" width="10" height="10" style="vertical-align: middle; margin-right: 4px;">`; // Decreased size

        // Social Media Icon Image URLs (using ik.imagekit.io as requested)
        const facebookIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/fb.png" alt="Facebook" width="14" height="14" style="vertical-align: middle;">`; // Decreased size
        const linkedinIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/lin.png" alt="LinkedIn" width="14" height="14" style="vertical-align: middle;">`; // Decreased size
        const youtubeIconImg = `<img src="https://ik.imagekit.io/mwyisb0h4/yt.png" alt="YouTube" width="14" height="14" style="vertical-align: middle;">`; // Decreased size
        const instagramIconImg = `<img src="${fixedInstagram ? fixedInstagram : 'https://ik.imagekit.io/mwyisb0h4/instagram.png'}" alt="Instagram" width="14" height="14" style="vertical-align: middle;">`; // Decreased size


        /**
         * Converts a string to Title Case (first letter of each word capitalized).
         * @param {string} str - The input string.
         * @returns {string} The string in Title Case.
         */
        function toTitleCase(str) {
            return str.replace(/\w\S*/g, function(txt) {
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            });
        }

        /**
         * Validates an email address against a list of allowed domains.
         * @param {string} email - The email address to validate.
         * @returns {boolean} True if the email is valid, false otherwise.
         */
        function isValidEmailDomain(email) {
            const allowedDomains = ['gmail.com', 'yahoo.com', 'radiantbd.com', 'hotmail.com'];
            const domain = email.split('@')[1];
            return allowedDomains.includes(domain);
        }

        /**
         * Generates the HTML string for the email signature based on current input values.
         * The HTML uses inline styles and a table layout for maximum compatibility with email clients.
         * @returns {string} The complete HTML string for the email signature.
         */
        function generateSignatureHtml() {
            // Get values from input fields.
            // Apply Title Case for name, title, and department
            const fullName = toTitleCase(fullNameInput.value);
            const title = toTitleCase(titleInput.value);
            const department = toTitleCase(departmentInput.value);
            // Email will be lowercase
            const email = emailInput.value.toLowerCase();
            const mobileNumber = mobileNumberInput.value;
            const sipNumber = sipNumberInput.value;

            // Dynamically generate phone numbers HTML based on input
            let phoneNumbersHtml = '';
            if (mobileNumber && sipNumber) {
                phoneNumbersHtml = `<p style="margin: 0; font-size: 10px; line-height: 1.5; color: #4a5568; margin-bottom: 4px; white-space: nowrap;">${phoneIconImg}<a href="tel:${mobileNumber}" style="color: #4a5568; text-decoration: none;">${mobileNumber}</a> <span style="padding: 0 2px;">|</span> <a href="tel:${sipNumber}" style="color: #4a5568; text-decoration: none;">${sipNumber}</a></p>`;
            } else if (mobileNumber) {
                phoneNumbersHtml = `<p style="margin: 0; font-size: 10px; line-height: 1.5; color: #4a5568; margin-bottom: 4px; white-space: nowrap;">${phoneIconImg}<a href="tel:${mobileNumber}" style="color: #4a5568; text-decoration: none;">${mobileNumber}</a></p>`;
            } else if (sipNumber) {
                phoneNumbersHtml = `<p style="margin: 0; font-size: 10px; line-height: 1.5; color: #4a5568; margin-bottom: 4px; white-space: nowrap;">${phoneIconImg}<a href="tel:${sipNumber}" style="color: #4a5568; text-decoration: none;">${sipNumber}</a></p>`;
            }

            // Dynamically generate title/department HTML
            let titleDepartmentHtml = '';
            if (title && department) {
                titleDepartmentHtml = `<p style="margin: 0; font-size: 11px; color: #1a1a1a; font-weight: 500; margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block;">${title} <span style="padding: 0 2px;">|</span> ${department}</p>`;
            } else if (title) {
                titleDepartmentHtml = `<p style="margin: 0; font-size: 11px; color: #1a1a1a; font-weight: 500; margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block;">${title}</p>`;
            } else if (department) {
                titleDepartmentHtml = `<p style="margin: 0; font-size: 11px; color: #1a1a1a; font-weight: 500; margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block;">${department}</p>`;
            } else {
                titleDepartmentHtml = `<p style="margin: 0; margin-bottom: 10px; display: block;"></p>`; // Empty paragraph for consistent spacing
            }

            // Using a table for address lines to ensure consistent alignment in email clients
            // fixedAddressPart2_line1 and fixedAddressPart2_line2 are used here
            const addressHtml = `
                <table cellpadding="0" cellspacing="0" border="0" style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 0; font-size: 10px; line-height: 1.5; color: #4a5568; vertical-align: top; width: 17px;">
                            ${mapPinIconImg}
                        </td>
                        <td style="padding: 0; font-size: 10px; line-height: 1.5; color: #4a5568; vertical-align: top; padding-left: 0;">
                            <span style="display: inline-block; white-space: nowrap;">${fixedAddressPart1}</span><br>
                            <span style="display: inline-block;">${fixedAddressPart2_line1}</span><br>
                            <span style="display: inline-block;">${fixedAddressPart2_line2}</span>
                        </td>
                    </tr>
                </table>
            `;

            // The main HTML structure for the email signature
            // Using a table for robust email client compatibility
            return `
                <table cellpadding="0" cellspacing="0" border="0" style="width: 320px; border-collapse: collapse; font-family: 'Mona Sans', Arial, sans-serif; color: #333333; line-height: 1.4;">
                    <tr>
                        <td valign="top" style="padding-right: 10px; width: 65%;">
                            <p style="margin: 0; font-size: 13px; font-weight: bold; color: #1F3760; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${fullName}</p>
                            ${titleDepartmentHtml}
                            ${phoneNumbersHtml}
                            <p style="margin: 0; font-size: 10px; line-height: 1.5; color: #4a5568; margin-bottom: 4px; white-space: nowrap;">${mailIconImg}<a href="mailto:${email}" style="color: #4a5568; text-decoration: none;">${email}</a></p>
                            ${addressHtml}
                        </td>
                        <td valign="middle" style="width: 35%; text-align: right; padding-right: 0px;">
                            <img src="${logoUrl}" alt="Company Logo" style="max-width: 150px; height: auto; display: block; border: 0; margin-left: auto; margin-right: 0;">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="padding-top: 10px;"> <!-- Adjusted padding-top for space -->
                            <table cellpadding="0" cellspacing="0" border="0" style="width: 100%; border-collapse: collapse; background-color: #2a3b7d;">
                                <tr>
                                    <td style="padding: 6px 10px; vertical-align: middle;">
                                        ${fixedWebsite ? `<a href="${fixedWebsite}" target="_blank" style="color: white; text-decoration: none; font-size: 10px; font-weight: 500; display: inline-block; vertical-align: middle;">${linkIconImg} ${fixedWebsite.replace(/^https?:\/\//, '')}</a>` : '<span></span>'}
                                    </td>
                                    <td style="padding: 6px 10px; text-align: right; vertical-align: middle;">
                                        <div style="display: inline-block; white-space: nowrap;">
                                            ${fixedFacebook ? `<a href="${fixedFacebook}" target="_blank" style="display: inline-block; margin-left: 6px;"><img src="https://ik.imagekit.io/mwyisb0h4/fb.png" alt="Facebook" width="14" height="14" style="vertical-align: middle;"></a>` : ''}
                                            ${fixedLinkedin ? `<a href="${fixedLinkedin}" target="_blank" style="display: inline-block; margin-left: 6px;"><img src="https://ik.imagekit.io/mwyisb0h4/lin.png" alt="LinkedIn" width="14" height="14" style="vertical-align: middle;"></a>` : ''}
                                            ${fixedYoutube ? `<a href="${fixedYoutube}" target="_blank" style="display: inline-block; margin-left: 6px;"><img src="https://ik.imagekit.io/mwyisb0h4/yt.png" alt="YouTube" width="14" height="14" style="vertical-align: middle;"></a>` : ''}
                                            ${fixedInstagram ? `<a href="${fixedInstagram}" target="_blank" style="display: inline-block; margin-left: 6px;"><img src="https://ik.imagekit.io/mwyisb0h4/instagram.png" alt="Instagram" width="14" height="14" style="vertical-align: middle;"></a>` : ''}
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            `;
        }

        /**
         * Function to set up the auto-prefixing and cursor positioning for phone number inputs.
         * @param {HTMLElement} inputElement - The input element to apply the behavior to.
         */
        function setupPhoneNumberInput(inputElement) {
            const prefix = '+88';

            inputElement.addEventListener('focus', () => {
                if (inputElement.value === '') {
                    inputElement.value = prefix;
                    // Set cursor position after +88
                    setTimeout(() => {
                        inputElement.setSelectionRange(prefix.length, prefix.length);
                    }, 0);
                }
            });

            inputElement.addEventListener('blur', () => {
                // If the input value is just '+88' (meaning nothing else was typed), clear it
                if (inputElement.value === prefix) {
                    inputElement.value = '';
                }
            });

            inputElement.addEventListener('input', (event) => {
                let currentValue = inputElement.value;
                let cursorPosition = inputElement.selectionStart;

                // Ensure it starts with prefix and only contains digits after prefix
                if (!currentValue.startsWith(prefix)) {
                    // If prefix is missing, re-add it and clean non-digits
                    const digitsOnly = currentValue.replace(/[^0-9]/g, '');
                    currentValue = prefix + digitsOnly;
                    inputElement.value = currentValue;
                    // Adjust cursor position
                    inputElement.setSelectionRange(prefix.length + digitsOnly.length, prefix.length + digitsOnly.length);
                } else {
                    // If it starts with prefix, just clean non-digits after prefix
                    const numberPart = currentValue.substring(prefix.length);
                    const cleanedNumberPart = numberPart.replace(/[^0-9]/g, '');
                    
                    if (cleanedNumberPart !== numberPart) {
                        inputElement.value = prefix + cleanedNumberPart;
                        // Adjust cursor position based on removed characters
                        inputElement.setSelectionRange(cursorPosition - (numberPart.length - cleanedNumberPart.length), cursorPosition - (numberPart.length - cleanedNumberPart.length));
                    }
                }
            });
        }

        /**
         * Updates the content of the iframe with the generated email signature HTML.
         * It also manages the visibility of the signature preview container.
         */
        function updateSignaturePreview() {
            // Apply Title Case to relevant inputs on input event
            // This is handled by the input event listeners directly on the fields
            
            // Apply Lowercase to email input on input event
            // This is handled by the input event listener directly on the email field

            // Validate email before generating signature
            let isEmailValid = true;
            // Only validate on blur or if the field is not empty
            if (event && event.type === 'blur' && emailInput.value.trim() !== '' && !isValidEmailDomain(emailInput.value)) {
                showMessageBox('Please enter a valid email address with a supported domain (@gmail.com, @yahoo.com, @radiantbd.com, @hotmail.com).');
                isEmailValid = false;
            } else if (event && event.type === 'blur' && emailInput.value.trim() === '') {
                 // If email field is empty on blur, ensure it's considered valid for preview purposes
                 isEmailValid = true;
            } else if (event && event.type === 'input') {
                // On input, allow preview to update, but if it's invalid, the blur will catch it
                isEmailValid = true; // Temporarily allow update on input, blur will re-validate
            }


            // Only update preview if email is valid or empty
            if (isEmailValid) {
                const signatureHtml = generateSignatureHtml();
                const iframeDoc = signatureFrame.contentDocument || signatureFrame.contentWindow.document;
                iframeDoc.open();
                // Write the full HTML document into the iframe, including necessary styles
                iframeDoc.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            body { margin: 0; padding: 0; overflow: hidden; }
                            /* Ensure styles are also present in the iframe for accurate preview */
                            /* Signature styles - these will be injected into the iframe and used for HTML copy */
                            .signature-container {
                                font-family: 'Mona Sans', Arial, sans-serif;
                                color: #333333;
                                max-width: 320px; /* Adjusted to a common email signature width */
                                width: 100%; /* Ensure it takes available width within the table */
                                box-sizing: border-box;
                                line-height: 1.4;
                                /* Removed transform: scale() for email client compatibility */
                                border-collapse: collapse; /* Ensure table borders collapse */
                            }
                            .signature-name {
                                font-size: 13px; /* Increased font size for name */
                                font-weight: bold;
                                color: #1F3760;
                                margin-bottom: 2px;
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                            }
                            .signature-title-department {
                                font-size: 11px; /* Adjusted to match email font size */
                                font-weight: 500;
                                color: #1a1a1a;
                                margin-bottom: 8px; /* Adjusted margin */
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                                display: block;
                            }
                            .signature-contact-item {
                                font-size: 10px; /* Decreased font size for mobile, SIP, email, address */
                                color: #4a5568;
                                line-height: 1.5;
                                margin-bottom: 2px; /* Adjusted margin */
                                white-space: nowrap; /* Keep contact items on one line */
                            }
                            .signature-contact-item img { /* Targeting images for icons */
                                vertical-align: middle;
                                margin-right: 5px; /* Consistent gap for all icons */
                                width: 12px; /* Adjusted icon size */
                                height: 12px; /* Adjusted icon size */
                            }
                            .signature-link-section {
                                background-color: #2a3b7d;
                                padding: 6px 8px; /* Adjusted padding */
                                /* Removed border-radius as it's often ignored */
                                /* Using table for layout instead of flex */
                                margin-top: 8px; /* Adjusted margin */
                            }
                            .signature-link-section a {
                                color: white;
                                text-decoration: none;
                                font-size: 10px; /* Decreased font size for website */
                                font-weight: 500;
                                /* Removed display: flex and align-items: center from here */
                            }
                            .signature-link-section a img { /* Targeting images for social icons */
                                margin-right: 3px; /* Adjusted margin */
                                width: 16px; /* Adjusted icon size */
                                height: 16px; /* Adjusted icon size */
                                vertical-align: middle;
                            }
                            .social-icons {
                                /* Handled by table cells in generated HTML */
                            }
                            .social-icons a {
                                display: inline-block;
                                margin-left: 6px; /* Adjusted margin */
                            }
                            .social-icons img {
                                width: 16px; /* Adjusted icon size */
                                height: 16px; /* Adjusted icon size */
                                vertical-align: middle;
                            }
                        </style>
                    </head>
                    <body>
                        ${signatureHtml}
                    </body>
                    </html>
                `);
                iframeDoc.close();

                // Adjust iframe height to fit its content dynamically
                setTimeout(() => {
                    const contentHeight = iframeDoc.body.scrollHeight;
                    if (contentHeight > 0) {
                        signatureFrame.style.height = contentHeight + 'px';
                    } else {
                        signatureFrame.style.height = '100px'; // A default height
                    }
                }, 0);
            }


            // Check if any input field has a value to determine preview visibility
            const inputs = [fullNameInput, titleInput, departmentInput, emailInput, mobileNumberInput, sipNumberInput];
            const anyInputHasValue = inputs.some(input => input.value.trim() !== '');

            if (anyInputHasValue) {
                signaturePreviewContainer.classList.add('visible');
            } else {
                signaturePreviewContainer.classList.remove('visible');
            }
        }

        // Initial setup for phone number inputs
        setupPhoneNumberInput(mobileNumberInput);
        setupPhoneNumberInput(sipNumberInput);

        // Event listeners for input transformations and validation
        fullNameInput.addEventListener('input', updateSignaturePreview);
        titleInput.addEventListener('input', updateSignaturePreview);
        departmentInput.addEventListener('input', updateSignaturePreview);
        
        // Email input specific listeners for lowercase and blur validation
        emailInput.addEventListener('input', updateSignaturePreview);
        emailInput.addEventListener('blur', updateSignaturePreview); 

        mobileNumberInput.addEventListener('input', updateSignaturePreview);
        sipNumberInput.addEventListener('input', updateSignaturePreview);

        // Initial update of the signature preview when the page loads
        document.addEventListener('DOMContentLoaded', updateSignaturePreview);

        // Event listener for "Copy HTML" button
        copyHtmlBtn.addEventListener('click', () => {
            const signatureHtml = generateSignatureHtml();
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = signatureHtml;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                // Use document.execCommand('copy') for clipboard operations
                const successful = document.execCommand('copy');
                if (successful) {
                    showMessageBox('HTML copied to clipboard!');
                } else {
                    showMessageBox('Failed to copy HTML. Please try again.');
                }
            } catch (err) {
                    console.error('Failed to copy HTML: ', err);
                    showMessageBox('Failed to copy HTML. Your browser might not support this feature. Please try manually selecting the preview content.');
            } finally {
                document.body.removeChild(tempTextArea); // Clean up the temporary textarea
            }
        });

        // Event listener for "Copy Visual" button
        copyVisualBtn.addEventListener('click', () => {
            const iframeDoc = signatureFrame.contentDocument || signatureFrame.contentWindow.document;
            const signatureElement = iframeDoc.querySelector('.signature-container');
            if (signatureElement) {
                const range = iframeDoc.createRange();
                range.selectNode(signatureElement); // Select the signature element
                const selection = iframeDoc.defaultView.getSelection();
                selection.removeAllRanges(); // Clear any existing selections
                selection.addRange(range); // Add the new selection

                try {
                    // Attempt to copy the selected content
                    const successful = iframeDoc.execCommand('copy');
                    if (successful) {
                        showMessageBox('Visual signature copied to clipboard!');
                    } else {
                        showMessageBox('Failed to copy visual signature directly. Please use "Copy HTML" and paste into your email client, or try manually selecting the preview content.');
                    }
                } catch (err) {
                    console.error('Failed to copy visual signature:', err);
                    showMessageBox('Failed to copy visual signature directly. Your browser might not support this feature or has security restrictions. Please use "Copy HTML" instead.');
                } finally {
                    selection.removeAllRanges(); // Deselect the content after copying
                }
            } else {
                showMessageBox('Signature element not found in preview. Please try again.');
            }
        });
    </script>

</body>
</html>
